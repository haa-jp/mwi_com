jQuery(function($){$.extend($.fn,{addValidation:function(e){return this.each(function(){this.inlineValidation.push(e)})},addServerValidation:function(e){return this.each(function(){this.serverValidation.push(new $.validator.serverValidator(this,e))})},addSubmitValidation:function(e){return this.each(function(){this.submitValidation.push(e)})},hasError:function(){var e=!1;return this.each(function(){return this.isValid?void 0:void(e=!0)}),e},clearForm:function(){return this.each(function(){if("form"==this.tagName.toLowerCase()||"fieldset"==this.tagName.toLowerCase())return $($.validator.validatedFields,this).clearForm();var e=$(this);e.is("select")?this.selectedIndex=-1:e.is(":radio,:checkbox")?this.checked=!1:this.value=""})},predictOzState:function(e){return this.change(function(){var i=$(this).val(),a="";i>=1e3&&2599>=i||i>=2619&&2898>=i||i>=2921&&2999>=i?a="NSW":i>=200&&299>=i||i>=2600&&2618>=i||i>=2900&&2920>=i?a="ACT":i>=3e3&&3999>=i||i>=8e3&&8999>=i?a="VIC":i>=4e3&&4999>=i||i>=9e3&&9999>=i?a="QLD":i>=5e3&&5999>=i?a="SA":i>=6e3&&6797>=i||i>=6800&&6999>=i?a="WA":i>=7e3&&7999>=i?a="TAS":i>=800&&999>=i&&(a="NT"),""!=a&&$(e).val(a)[0].checkValid()})},initValidation:function(){return this.moderniz().each(function(){this.validate=$.validator.checkInputValid,this.checkValid=function(e){return this.clearError(),this.validate(e)||this.displayError(),this.isValid},this.displayError=$.validator.displayError,this.clearError=$.validator.clearError,this.inlineValidation=[],this.serverValidation=[],this.submitValidation=[],this.hasSubmitError=!1,this.originalValue=$(this).val(),this.isDirty=function(){return $(this).val()!=this.originalValue}}).focus($.validator.showError).hover($.validator.showError,$.validator.hideError).blur($.validator.hideError),this.filter("input[type=email]").blur(function(){this.value=$.trim(this.value)}),this.filter("."+$.validator.rule.date).blur(function(){""!=this.value&&$.validator.isDate(this.value)&&(this.value=this.value.toDate($(this).hasClass("birth")).format("dd/mm/yyyy"))}),this.filter("."+$.validator.rule.currency+", ."+$.validator.rule.positive_currency).change(function(){if(""!=this.value&&$.validator.isCurrency(this.value)){var e=$(this),i="$";e.hasClass("GBP")?i="£":e.hasClass("EUR")?i="€":e.hasClass("JPY")&&(i="¦"),this.value=e.hasClass("whole")?this.value.toFloat().toWholeCurrency(i):this.value.toFloat().toCurrency(i)}}),this.filter("."+$.validator.rule.postcode).each(function(){var e=$(this);e.data("stateField")&&e.predictOzState("#"+e.data("stateField"))}),this.filter(":not[:radio]").blur(function(){(!this.required&&"required"!=$(this).attr("required")&&""==this.value||""!=this.value)&&this.checkValid()}),this.filter("input:radio, input:checkbox").each(function(){this.parent=$(this).closest($.validator.parentElements),this.label="radio"===this.type?$(this).parent("label"):this.parent.find("label[for='"+this.id+"']")}).click(function(){this.parent.find("input[name='"+this.name+"']").each(function(){this.checkValid()})}),this.filter("select").change(function(){""!=this.value&&this.checkValid()}),this},initFormValidation:function(){return this.attr("novalidate","novalidate").each(function(){this.validate=!0,this.checkValid=function(){try{if(!this.validate)return!0;var e=this;return e.invalidElements=[],$($.validator.validatedFields,e).each(function(){this.checkValid(!0)||e.invalidElements.push(this)}),0===e.invalidElements.length?!0:(alert($.validator.message.submitFailed),e.invalidElements[0].focus(),!1)}catch(i){return alert("An error has occurred:\n"+i),!0}}}).submit(function(){return this.checkValid()}),$(":submit",this).click(function(){this.form.clickedSubmit=this}),$($.validator.validatedFields,this).initValidation(),this},setFieldToggle:function(e){return this.each(function(){var i=$(this);i.change(function(){i.toggleField(e)}),i.toggleField(e,0)})},toggleField:function(e,i){return this.each(function(){i||(i="fast"),this.checked||this.value===e.data("visibleValue")?e.slideDown(i):e.slideUp(i)})}})}),$(function(){$.validator=function(){},$.extend($.validator,{rule:{no_whitespace:"no_whitespace",mobile:"mobile",phone:"phone",postcode:"postcode",date:"date",time:"time",year:"year",numeric:"numeric",positive_numeric:"positive_numeric",integer:"integer",positive_integer:"positive_integer",currency:"currency",positive_currency:"positive_currency",credit_card:"credit_card",csc:"csc"},parentElements:"p,td,th,li",validatedFields:"input:text, input:password, input:radio, input:checkbox, input:file, input[type=email], input[type=tel], input[type=url], input[type=search], select, textarea",serverValidator:function(e,i){var a=this;a.settings=$.extend({path:"",handler:function(e){this.isValid=""==(this.errorMessage=e.Message),this.displayError()},getValue:function(){return a.target.value}},i),a.target=e,a.validate=function(e){$.ajax({url:a.settings.path+a.settings.getValue()+"&caller="+a.target.id,dataType:"json",async:!e,context:a.target,success:a.settings.handler})}},showError:function(){if(this.error&&!this.isValid){var e=$(this),i=(e.offsetParent().is(this.parent)?this.parent:this.parent.offsetParent()).offset(),a=e.offset();this.error.show().css({top:a.top+e.outerHeight()-i.top,left:a.left-i.left})}},hideError:function(){this.error&&!$(this).is(":focus")&&this.error.hide()},displayError:function(){this.isValid||(this.parent||(this.parent=$(this).closest($.validator.parentElements)),this.label&&this.label.addClass("alert"),this.error||(this.error=$('<label for="'+this.id+'" role="alert" class="errata js-hover"/>')),this.error.html(this.errorMessage).appendTo(this.parent).hide(),$(this).addClass("invalid").attr("aria-invalid","true"))},clearError:function(){this.parent||(this.parent=$(this).closest($.validator.parentElements)),this.parent.children(".server-error").remove(),this.label&&this.label.removeClass("alert"),$(this).removeClass("invalid").removeAttr("aria-invalid"),this.error&&this.error.hide()},checkInputValid:function(e){var i=this,a=$(i);if(i.isValid=!0,i.disabled||i.readOnly||a.is(":hidden"))return!0;if(a.data("requiredField")){var t=$("#"+a.data("requiredField"));i.required=t.attr("checked")||t.val()==a.data("requiredValue")}var r=a.attr("type");if(i.required||"required"==a.attr("required"))switch(r){case"select-multiple":if(!(i.isValid=-1!==i.selectedIndex))return i.errorMessage=$.validator.message.selectRequired,!1;break;case"select-one":if(!(i.isValid=-1!=this.selectedIndex&&!(0===this.selectedIndex&&this.options[0]&&""===this.options[0].value)))return i.errorMessage=$.validator.message.selectRequired,!1;break;case"radio":if($(i).closest($.validator.parentElements)[0].disabled)break;if(!(i.isValid=0!==$(i).closest($.validator.parentElements).find(":checked").length))return i.errorMessage=$.validator.message.radioRequired,!1;break;case"checkbox":if(!(i.isValid=i.checked))return i.errorMessage=$.validator.message.checkRequired,!1;break;default:if(!(i.isValid=0!==i.value.length))return i.errorMessage=$.validator.message.required,!1}switch(r){case"email":if(!(i.isValid=$.validator.isMail(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.email,!1;break;case"tel":if(a.hasClass($.validator.rule.mobile)){if(!(i.isValid=$.validator.isMobile(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.mobile,!1}else if(!(i.isValid=$.validator.isPhoneNumber(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.phone,!1;break;case"text":if(a.hasClass($.validator.rule.no_whitespace)&&!(i.isValid=$.trim(i.value).length>0||0===i.value.length))return i.errorMessage=$.validator.message.whitespace,!1;if(a.hasClass($.validator.rule.postcode)&&!(i.isValid=$.validator.isPostCode(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.postcode,!1;if(a.hasClass($.validator.rule.date)&&!(i.isValid=$.validator.isDate(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.date,!1;if(a.hasClass($.validator.rule.time)&&!(i.isValid=$.validator.isTime(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.time,!1;if(a.hasClass($.validator.rule.year)&&!(i.isValid=$.validator.isYear(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.year,!1;if(a.hasClass($.validator.rule.numeric)&&!(i.isValid=!isNaN(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.number,!1;if(a.hasClass($.validator.rule.positive_numeric)&&!(i.isValid=!isNaN(i.value)&&-1===i.value.indexOf("-")||0===i.value.length))return i.errorMessage=$.validator.message.positiveNumber,!1;if(a.hasClass($.validator.rule.integer)&&!(i.isValid=!isNaN(i.value)&&-1===i.value.indexOf(".")||0===i.value.length))return i.errorMessage=$.validator.message.integer,!1;if(a.hasClass($.validator.rule.positive_integer)&&!(i.isValid=!isNaN(i.value)&&-1===i.value.indexOf("-")&&-1===i.value.indexOf(".")||0===i.value.length))return i.errorMessage=$.validator.message.positiveInteger,!1;if(a.hasClass($.validator.rule.currency)&&!(i.isValid=$.validator.isCurrency(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.currency,!1;if(a.hasClass($.validator.rule.positive_currency)&&!(i.isValid=$.validator.isCurrency(i.value)&&-1==i.value.indexOf("-")||0===i.value.length))return i.errorMessage=$.validator.message.currency,!1;if(a.hasClass($.validator.rule.credit_card)&&!(i.isValid=$.validator.isCCNumber(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.credit_card,!1;if(a.hasClass($.validator.rule.csc)&&!(i.isValid=$.validator.isCSC(i.value)||0===i.value.length))return i.errorMessage=$.validator.message.csc,!1}return i.inlineValidation.forEach(function(e){return e(i),i.isValid?void 0:!1}),i.serverValidation.forEach(function(a){return a.validate(e),i.isValid?void 0:!1}),e&&(i.submitValidation.length>0&&(i.hasSubmitError=!1),i.submitValidation.forEach(function(e){return e(i),i.isValid?void 0:(i.hasSubmitError=!0,!1)})),i.isValid&&(i.errorMessage=""),i.isValid}});var e=$("form").not("[novalidate]").initFormValidation();$(".invalid label.server-error",e).each(function(i){var a=$(this);$("[id^="+this.className.replace(/.*\sfor-(\w*).*/,"$1")+"]",e).each(function(e){this.errorMessage=a.html(),this.isValid=!1,this.displayError(),this.parent.removeClass("invalid"),i+e==0&&this.focus()}),a.remove()}),$("[data-visible-field]").each(function(){var e=$(this);$("#"+e.data("visibleField")).setFieldToggle(e)})});